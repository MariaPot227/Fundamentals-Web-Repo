<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SBA Movies Practice</title>
<style>
body {
    font-family: Arial, sans-serif;
    margin: 20px;
    color: #222;
}

h2 { font-size: 1.5em; text-transform: uppercase; }
h3 { font-size: 1.2em; text-transform: uppercase; margin: 5px 0; }

.card, .movie-card {
    border: 1px solid #222;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
}

.card img, .movie-card img {
    width: 100%;
    max-height: 400px;
    object-fit: cover;
    border-radius: 4px;
    margin-bottom: 10px;
}

.cards-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-top: 20px;
}

@media (max-width: 800px) { .cards-container { grid-template-columns: repeat(2,1fr); } }
@media (max-width: 500px) { .cards-container { grid-template-columns: 1fr; } }

.filter-container { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px; }
.search-container input { padding: 5px; width: 200px; }
</style>
</head>
<body>

<h1>Single Movie Card</h1>
<div class="card" id="single-movie-card"></div>

<h1>Movies List</h1>
<div class="filter-container">
    <select id="yearFilter">
        <option value="all">All Years</option>
    </select>
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Search by title...">
    </div>
</div>

<div class="cards-container" id="moviesContainer"></div>

<script>
const singleMovieCard = document.getElementById("single-movie-card");
const moviesContainer = document.getElementById("moviesContainer");
const searchInput = document.getElementById("searchInput");
const yearFilter = document.getElementById("yearFilter");

let moviesData = [];

// Task 1: Render single movie
function renderSingleMovie(movie) {
    singleMovieCard.innerHTML = `
        <img src="${movie.poster}" alt="${movie.title}">
        <h2>${movie.title}</h2>
        <h3>Genre</h3><p>${movie.genre}</p>
        <h3>Year</h3><p>${movie.year}</p>
        <h3>Director</h3><p>${movie.director}</p>
    `;
}

// Task 2: Fetch multiple movies
async function fetchMovies() {
    try {
        const res = await fetch("https://api.sampleapis.com/movies/animation");
        moviesData = await res.json();
        populateYearFilter();
        renderMovies(moviesData);
    } catch(err) {
        console.error("Error fetching movies:", err);
    }
}

// Task 2/3: Render multiple movies
function renderMovies(data) {
    moviesContainer.innerHTML = "";
    data.forEach(movie => {
        const card = document.createElement("div");
        card.className = "movie-card";
        card.innerHTML = `
            <img src="${movie.posterURL || 'https://via.placeholder.com/300x400'}" alt="${movie.title}">
            <h3>${movie.title}</h3>
            <p>${movie.releaseDate || "Unknown"}</p>
            <p>${movie.genres?.join(", ") || "N/A"}</p>
        `;
        moviesContainer.appendChild(card);
    });
}

// Task 3: Populate year dropdown
function populateYearFilter() {
    const years = [...new Set(moviesData.map(m => m.releaseDate?.split("-")[0]).filter(Boolean))].sort();
    years.forEach(year => {
        const option = document.createElement("option");
        option.value = year;
        option.textContent = year;
        yearFilter.appendChild(option);
    });
}

// Task 3: Filter movies
function filterMovies() {
    const searchTerm = searchInput.value.toLowerCase();
    const selectedYear = yearFilter.value;
    let filtered = moviesData;

    if(selectedYear !== "all") {
        filtered = filtered.filter(m => m.releaseDate?.startsWith(selectedYear));
    }

    if(searchTerm) {
        filtered = filtered.filter(m => m.title.toLowerCase().includes(searchTerm));
    }

    renderMovies(filtered);
}

// Event listeners
yearFilter.addEventListener("change", filterMovies);
searchInput.addEventListener("input", filterMovies);

// Initialize
renderSingleMovie({
    title: "Inception",
    genre: "Science Fiction",
    year: 2010,
    director: "Christopher Nolan",
    poster: "https://via.placeholder.com/300x400"
});
fetchMovies();
</script>

</body>
</html>
